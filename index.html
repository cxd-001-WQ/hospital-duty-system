<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>辽宁方大总医院 - 值班信息发布系统</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }

        body {
            width: 100vw;
            height: 100vh;
            background: linear-gradient(135deg, #0c2c5e 0%, #1a4789 100%);
            color: #fff;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .main-container {
            width: 90%;
            max-width: 1200px;
            height: 90%;
            display: flex;
            flex-direction: column;
            padding: 40px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .hospital-name h1 {
            font-size: 46px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .hospital-name h2 {
            font-size: 28px;
            opacity: 0.9;
        }

        .date-section {
            text-align: center;
            margin-bottom: 30px;
        }

        .current-date {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .duty-title {
            font-size: 32px;
            text-align: center;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .duty-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
            flex: 1;
        }

        .duty-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 25px 40px;
            border-radius: 12px;
            flex: 1;
            min-height: 120px;
        }

        .duty-type {
            font-size: 30px;
            font-weight: bold;
            width: 220px;
        }

        .duty-info {
            flex-grow: 1;
            text-align: center;
        }

        .duty-name {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .duty-phone {
            font-size: 26px;
            opacity: 0.9;
        }

        .weather-section {
            display: flex;
            justify-content: center;
            gap: 100px;
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 12px;
        }

        .weather-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .weather-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .weather-label {
            font-size: 24px;
            margin-bottom: 8px;
            opacity: 0.9;
        }

        .weather-value {
            font-size: 28px;
            font-weight: bold;
        }

        .values-section {
            text-align: center;
            padding-top: 20px;
            border-top: 2px solid rgba(255, 255, 255, 0.2);
        }

        .values-text {
            font-size: 26px;
            font-weight: bold;
            color: #4a90e2;
        }

        .update-status {
            position: fixed;
            bottom: 10px;
            right: 10px;
            font-size: 14px;
            opacity: 0.7;
        }
    </style>
</head>

<body>
    <div class="main-container">
        <div class="header">
            <div class="hospital-name">
                <h1>辽宁方大总医院</h1>
                <h2>LIAONING FANGDA GENERAL HOSPITAL</h2>
            </div>
        </div>

        <div class="date-section">
            <div class="current-date" id="current-date"></div>
        </div>

        <div class="duty-title">今日值班表</div>

        <div class="duty-list">
            <div class="duty-item">
                <div class="duty-type">行政总值班：</div>
                <div class="duty-info">
                    <div class="duty-name" id="admin-name"></div>
                    <div class="duty-phone" id="admin-phone"></div>
                </div>
            </div>

            <div class="duty-item">
                <div class="duty-type">医疗总值班：</div>
                <div class="duty-info">
                    <div class="duty-name" id="medical-name"></div>
                    <div class="duty-phone" id="medical-phone"></div>
                </div>
            </div>

            <div class="duty-item">
                <div class="duty-type">护理总值班：</div>
                <div class="duty-info">
                    <div class="duty-name" id="nursing-name"></div>
                    <div class="duty-phone" id="nursing-phone"></div>
                </div>
            </div>
        </div>

        <div class="weather-section">
            <div class="weather-item">
                <div class="weather-icon" id="weather-icon">⛅</div>
                <div class="weather-label">今日天气</div>
                <div class="weather-value" id="weather-text">多云</div>
            </div>

            <div class="weather-item">
                <div class="weather-icon">🌡️</div>
                <div class="weather-label">当前气温</div>
                <div class="weather-value" id="temperature-range">-5~9℃</div>
            </div>
        </div>

        <div class="values-section">
            <div class="values-text">对国家有利 · 对社会有利 · 对医患有利</div>
        </div>
    </div>

    <div class="update-status" id="update-status">最后更新：加载中...</div>

    <script>
        // 高德开放平台API密钥
        const AMAP_API_KEY = "2cdc8dd1eab44066b87dff56bf98cfd3";
        // 城市编码 - 沈阳市
        const CITY_CODE = "210100";
        
        const dutyData = [
            { "日期": "2025-10-01", "行政值班姓名": "历大维", "行政值班电话": "16609809779", "医疗值班姓名": "孙秀云(白班)/束馨(夜班)", "医疗值班电话": "15694138407/15640490138", "护理值班姓名": "常莉", "护理值班电话": "18900913733" },
            { "日期": "2025-10-02", "行政值班姓名": "白金", "行政值班电话": "13840416643", "医疗值班姓名": "慈健(白班)/廖威(夜班)", "医疗值班电话": "18900916916/13998166559", "护理值班姓名": "董建", "护理值班电话": "18900912751" },
            { "日期": "2025-10-03", "行政值班姓名": "郭妍", "行政值班电话": "16609801616", "医疗值班姓名": "杨金华(白班)/王蓓蓓(夜班)", "医疗值班电话": "16640121600/17790991230", "护理值班姓名": "董林", "护理值班电话": "18802423263" },
            { "日期": "2025-10-04", "行政值班姓名": "袁和利", "行政值班电话": "13066597427", "医疗值班姓名": "印春铭(白班)/张睿(夜班)", "医疗值班电话": "18900912998/17702485789", "护理值班姓名": "杨红娜", "护理值班电话": "13704034277" },
            { "日期": "2025-10-05", "行政值班姓名": "高彩霞", "行政值班电话": "18900916161", "医疗值班姓名": "秦丽莉(白班)/蔡军(夜班)", "医疗值班电话": "16640121191/15698938668", "护理值班姓名": "郭晓林", "护理值班电话": "17261619512" },
            { "日期": "2025-10-06", "行政值班姓名": "张旭", "行政值班电话": "13332428666", "医疗值班姓名": "邬志强(白班)/王森(夜班)", "医疗值班电话": "15843076811/13940342515", "护理值班姓名": "苏丹", "护理值班电话": "13555762755" },
            { "日期": "2025-10-07", "行政值班姓名": "刘丹", "行政值班电话": "16609800202", "医疗值班姓名": "艾红军(白班)/郭海涛(夜班)", "医疗值班电话": "13940066221/18909885460", "护理值班姓名": "董维苓", "护理值班电话": "18641365499" },
            { "日期": "2025-10-08", "行政值班姓名": "刘艳军", "行政值班电话": "16609801501", "医疗值班姓名": "董锡钧(白班)/蔡鸿丹(夜班)", "医疗值班电话": "13944881064/13940396202", "护理值班姓名": "王丽君", "护理值班电话": "15694238845" },
            { "日期": "2025-10-09", "行政值班姓名": "白金", "行政值班电话": "13840416643", "医疗值班姓名": "陈梅(夜班)", "医疗值班电话": "13309887409", "护理值班姓名": "孙璟婕", "护理值班电话": "13309880386" },
            { "日期": "2025-10-10", "行政值班姓名": "郭妍", "行政值班电话": "16609801616", "医疗值班姓名": "张金良(夜班)", "医疗值班电话": "15840036966", "护理值班姓名": "胡晓云", "护理值班电话": "18940251836" },
            { "日期": "2025-10-11", "行政值班姓名": "袁和利", "行政值班电话": "13066597427", "医疗值班姓名": "孙晶(夜班)", "医疗值班电话": "15140001218", "护理值班姓名": "范明明", "护理值班电话": "13604057758" },
            { "日期": "2025-10-12", "行政值班姓名": "孙久海", "行政值班电话": "13889285525", "医疗值班姓名": "富沛涛(白班)/边瓯(夜班)", "医疗值班电话": "13944925826/13309881289", "护理值班姓名": "葛峰", "护理值班电话": "17802462806" },
            { "日期": "2025-10-13", "行政值班姓名": "高彩霞", "行政值班电话": "18900916161", "医疗值班姓名": "翟召锋(夜班)", "医疗值班电话": "16640121336", "护理值班姓名": "兰雪", "护理值班电话": "15840276676" },
            { "日期": "2025-10-14", "行政值班姓名": "张旭", "行政值班电话": "13332428666", "医疗值班姓名": "张全(夜班)", "医疗值班电话": "15694138227", "护理值班姓名": "孟微", "护理值班电话": "18302467771" },
            { "日期": "2025-10-15", "行政值班姓名": "刘丹", "行政值班电话": "16609800202", "医疗值班姓名": "戚凤君(夜班)", "医疗值班电话": "15694236221", "护理值班姓名": "郑秀红", "护理值班电话": "15694138489" },
            { "日期": "2025-10-16", "行政值班姓名": "刘艳军", "行政值班电话": "16609801501", "医疗值班姓名": "高艳霞(夜班)", "医疗值班电话": "15694239109", "护理值班姓名": "郑莉美", "护理值班电话": "13166759151" },
            { "日期": "2025-10-17", "行政值班姓名": "胡海华", "行政值班电话": "18007084347", "医疗值班姓名": "荆波(夜班)", "医疗值班电话": "13840456644", "护理值班姓名": "赵红艳", "护理值班电话": "15309885937" },
            { "日期": "2025-10-18", "行政值班姓名": "吕兴旺", "行政值班电话": "16609809127", "医疗值班姓名": "王成坤(白班)/尤义(夜班)", "医疗值班电话": "13341576675/13841947940", "护理值班姓名": "李梅丽", "护理值班电话": "18204020840" },
            { "日期": "2025-10-19", "行政值班姓名": "梁佳慧子", "行政值班电话": "16609808896", "医疗值班姓名": "王传铭(白班)/曹业宏(夜班)", "医疗值班电话": "13804037985/16640121099", "护理值班姓名": "周静", "护理值班电话": "13940080021" },
            { "日期": "2025-10-20", "行政值班姓名": "梁秀华", "行政值班电话": "17702489885", "医疗值班姓名": "经子兰(夜班)", "医疗值班电话": "15040399620", "护理值班姓名": "吴东霞", "护理值班电话": "15809887636" },
            { "日期": "2025-10-21", "行政值班姓名": "邓新", "行政值班电话": "15998355997", "医疗值班姓名": "郭一君(夜班)", "医疗值班电话": "17790992735", "护理值班姓名": "曹军", "护理值班电话": "13998328901" },
            { "日期": "2025-10-22", "行政值班姓名": "王鹏", "行政值班电话": "16693161316", "医疗值班姓名": "张丹(夜班)", "医疗值班电话": "15694138582", "护理值班姓名": "黄丹丹", "护理值班电话": "13940529066" },
            { "日期": "2025-10-23", "行政值班姓名": "刘迎秋", "行政值班电话": "15040036592", "医疗值班姓名": "周丽娜(夜班)", "医疗值班电话": "15698930729", "护理值班姓名": "林宁", "护理值班电话": "18909822128" },
            { "日期": "2025-10-24", "行政值班姓名": "马威", "行政值班电话": "16609805488", "医疗值班姓名": "张妍(夜班)", "医疗值班电话": "15694239039", "护理值班姓名": "巩雪媛", "护理值班电话": "13998853374" },
            { "日期": "2025-10-25", "行政值班姓名": "杜继峰", "行政值班电话": "13840099224", "医疗值班姓名": "陈琳(白班)/束馨(夜班)", "医疗值班电话": "16640120837/15640490138", "护理值班姓名": "董雅娟", "护理值班电话": "18900912055" },
            { "日期": "2025-10-26", "行政值班姓名": "王丹", "行政值班电话": "13889814568", "医疗值班姓名": "梁勇(白班)/廖威(夜班)", "医疗值班电话": "13352451128/13998166559", "护理值班姓名": "别爱玉", "护理值班电话": "15694239032" },
            { "日期": "2025-10-27", "行政值班姓名": "冯秀艳", "行政值班电话": "18002453727", "医疗值班姓名": "王蓓蓓(夜班)", "医疗值班电话": "17790991230", "护理值班姓名": "高丽丽", "护理值班电话": "13909831619" },
            { "日期": "2025-10-28", "行政值班姓名": "王莹", "行政值班电话": "15309883664", "医疗值班姓名": "张睿(夜班)", "医疗值班电话": "17702485789", "护理值班姓名": "王俊杰", "护理值班电话": "18900912288" },
            { "日期": "2025-10-29", "行政值班姓名": "刘子豪", "行政值班电话": "15140238567", "医疗值班姓名": "蔡军(夜班)", "医疗值班电话": "15698938668", "护理值班姓名": "杜镇宏", "护理值班电话": "18940287818" },
            { "日期": "2025-10-30", "行政值班姓名": "都兴超", "行政值班电话": "18640038009", "医疗值班姓名": "王森(夜班)", "医疗值班电话": "13940342515", "护理值班姓名": "董晓黎", "护理值班电话": "15140258349" },
            { "日期": "2025-10-31", "行政值班姓名": "杨琨", "行政值班电话": "13504020704", "医疗值班姓名": "郭海涛(夜班)", "医疗值班电话": "18909885460", "护理值班姓名": "常莉", "护理值班电话": "18900913733" }
        ];

        function initData() {
            // 初始加载时更新所有数据
            updateAllData();
            
            // 设置定时器，每天早上8点更新
            setInterval(function () {
                const now = new Date();
                // 检查是否是早上8点整
                if (now.getHours() === 8 && now.getMinutes() === 0) {
                    updateAllData();
                }
            }, 60000); // 每分钟检查一次

            // 添加每10分钟自动刷新页面的定时器 (10分钟 = 600000毫秒)
            setInterval(function() {
                location.reload();
            }, 600000);
        }

        // 更新所有数据（值班信息和天气）
        function updateAllData() {
            updateDutyInfo();
            updateWeatherInfo();
            
            // 更新最后更新时间
            const now = new Date();
            document.getElementById('update-status').textContent = `最后更新：${now.toLocaleString()}`;
        }

        // 更新值班信息
        function updateDutyInfo() {
            const today = new Date();
            const dateStr = formatDate(today);
            document.getElementById('current-date').textContent = formatDateDisplay(today);

            const todayData = dutyData.find(data => data.日期 === dateStr) || getDefaultData();
            document.getElementById('admin-name').textContent = todayData.行政值班姓名;
            document.getElementById('admin-phone').textContent = todayData.行政值班电话;
            document.getElementById('medical-name').textContent = todayData.医疗值班姓名;
            document.getElementById('medical-phone').textContent = todayData.医疗值班电话;
            document.getElementById('nursing-name').textContent = todayData.护理值班姓名;
            document.getElementById('nursing-phone').textContent = todayData.护理值班电话;
        }

        // 更新天气信息
        function updateWeatherInfo() {
            // 调用高德天气API，使用沈阳的城市编码
            const weatherUrl = `https://restapi.amap.com/v3/weather/weatherInfo?city=${CITY_CODE}&key=${AMAP_API_KEY}&extensions=base`;
            
            fetch(weatherUrl)
                .then(response => {
                    // 检查HTTP响应状态
                    if (!response.ok) {
                        throw new Error(`HTTP错误，状态码: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    // 检查API返回的状态是否正常
                    if (data.status === "1" && data.lives && data.lives.length > 0) {
                        const weather = data.lives[0];
                        // 更新天气信息
                        document.getElementById('weather-text').textContent = weather.weather;
                        document.getElementById('temperature-range').textContent = `${weather.temperature}℃`;
                        
                        // 更新天气图标
                        updateWeatherIcon(weather.weather);
                    } else {
                        // API返回格式错误时显示"更新中"
                        setWeatherUpdating();
                    }
                })
                .catch(error => {
                    console.error("获取天气数据失败:", error);
                    // 网络错误或其他异常时显示"更新中"
                    setWeatherUpdating();
                });
        }

        // 天气获取失败时显示"更新中"
        function setWeatherUpdating() {
            document.getElementById('weather-text').textContent = "更新中";
            document.getElementById('temperature-range').textContent = "更新中";
            // 保持原有图标不变，避免闪烁
        }

        // 根据天气状况更新图标
        function updateWeatherIcon(weatherText) {
            const iconElement = document.getElementById('weather-icon');
            weatherText = weatherText.toLowerCase();
            
            if (weatherText.includes('晴')) {
                iconElement.textContent = '☀️';
            } else if (weatherText.includes('云') || weatherText.includes('阴')) {
                iconElement.textContent = '⛅';
            } else if (weatherText.includes('雨')) {
                iconElement.textContent = '🌧️';
            } else if (weatherText.includes('雪')) {
                iconElement.textContent = '❄️';
            } else if (weatherText.includes('雾')) {
                iconElement.textContent = '🌫️';
            } else if (weatherText.includes('雷')) {
                iconElement.textContent = '⛈️';
            } else {
                iconElement.textContent = '🌤️';
            }
        }

        // 格式化日期为YYYY-MM-DD
        function formatDate(date) {
            return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
        }

        // 格式化日期显示为YYYY年MM月DD日
        function formatDateDisplay(date) {
            return `${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}日`;
        }

        // 获取默认值班数据
        function getDefaultData() {
            return {
                行政值班姓名: "待安排",
                行政值班电话: "暂无",
                医疗值班姓名: "待安排",
                医疗值班电话: "暂无",
                护理值班姓名: "待安排",
                护理值班电话: "暂无"
            };
        }

        // 页面加载完成后初始化数据
        window.onload = initData;
    </script>
</body>

</html>